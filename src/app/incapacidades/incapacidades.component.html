<h2>ğŸ¥ Registrar incapacidad o permiso sin goce</h2>

<div class="form">

    <!-- Empleado -->
    <label>Empleado:</label>
    <select [(ngModel)]="empleadoId" (change)="seleccionarEmpleado(empleadoId)">
        <option value="" disabled selected>Seleccione un empleado</option>
        <option *ngFor="let e of empleados" [value]="e.id">
            {{ e.nombre }} ({{ e.cedula }})
        </option>
    </select>

    <!-- Tipo -->
    <label>Tipo de incapacidad o permiso:</label>
    <select [(ngModel)]="tipo">
        <option value="" disabled selected>Seleccione el tipo</option>
        <option value="enfermedad">Enfermedad</option>
        <option value="accidente">Accidente laboral</option>
        <option value="maternidad">Maternidad</option>
        <option value="permisosg">Permiso sin goce salarial</option>
        <option value="paternidad">Paternidad</option>
    </select>

    <!-- Fechas -->
    <label>Fecha inicio:</label>
    <input type="date" [(ngModel)]="fechaInicio" (change)="calcularDias()" [disabled]="estadoBotones">

    <label>Fecha fin:</label>
    <input type="date" [(ngModel)]="fechaFin" (change)="calcularDias()" [disabled]="estadoBotones">

    <!-- NÃºmero de incapacidad -->
    <label>NÃºmero de incapacidad:</label>
    <input type="text" [(ngModel)]="numIncapacidad" placeholder="Ej: 123456" [disabled]="estadoBotones">

    <!-- Botones -->
    <div class="btns">
        <button [disabled]="!empleadoId || !fechaInicio || !fechaFin || !tipo || !numIncapacidad"
            (click)="guardarIncapacidad()">
            ğŸ’¾ Registrar incapacidad
        </button>

        <button class="sec" (click)="limpiar()">ğŸ§¹ Limpiar</button>

        <button class="info-btn" (click)="mostrarInfo = !mostrarInfo">
            ğŸ“˜ InformaciÃ³n de reglamento
        </button>
    </div>

    <!-- DÃ­as calculados -->
    <p *ngIf="fechaInicio && fechaFin">ğŸ—“ Total dÃ­as: {{ calcularDias() }}</p>
</div>

<!-- Panel informativo -->
<div class="info-panel" *ngIf="mostrarInfo">
    <h3>ğŸ“‹ Reglamento sobre incapacidades</h3>
    <p>ğŸ”¹ <strong>DÃ­as 1 al 3:</strong> El patrono paga el <strong>50%</strong> del salario diario. La CCSS no cubre
        incapacidades menores a 3 dÃ­as.</p>
    <p>ğŸ”¹ <strong>Del dÃ­a 4 en adelante:</strong> Ãšnicamente la CCSS paga el <strong>60%</strong> del salario promedio
        reportado.
    </p>
    <p>ğŸ”¹ <strong>Accidente laboral:</strong> El INS paga el <strong>67%</strong> del salario desde el primer dÃ­a.</p>
    <p>ğŸ”¹ <strong>Maternidad:</strong> La CCSS paga el <strong>100%</strong> del salario (1 mes antes y 3 meses despuÃ©s
        del parto).</p>
    <p>ğŸ”¹ <strong>Paternidad:</strong> El trabajador tiene derecho a <strong>8 dÃ­as hÃ¡biles</strong>
        (2 dÃ­as por semana durante 4 semanas). Si el patrono - empleado acuerdan, pueden otorgarlos de forma continua.
    </p>


    <h4>âš–ï¸ Base legal</h4>
    <ul>
        <li><strong>CCSS:</strong> Reglamento del Seguro de Salud, arts. 79, 80, 92, 93.</li>
        <li><strong>CÃ³digo de Trabajo:</strong> Art. 231 (Riesgos del trabajo).</li>
    </ul>
</div>

<hr>

<!-- Lista de incapacidades -->
<h2>ğŸ“‹ Incapacidades registradas</h2>

<div *ngIf="!empleadoSeleccionado">
    <p>ğŸ‘ˆ Seleccione un empleado para ver sus incapacidades.</p>
</div>

<table *ngIf="empleadoSeleccionado && incapacidades.length > 0" border="1" cellpadding="6">
    <thead>
        <tr>
            <th>Empleado</th>
            <th>Tipo</th>
            <th>Fecha Inicio</th>
            <th>Fecha Fin</th>
            <th>DÃ­as</th>
            <th>NÂ° Incapacidad</th>
            <th>Mes</th>
            <th>Acciones</th>
        </tr>
    </thead>

    <tbody>
        <tr *ngFor="let i of incapacidades">
            <td>{{ empleadoSeleccionado?.nombre }}</td>
            <td>
                {{
                i.tipo === 'enfermedad' ? 'Enfermedad' :
                i.tipo === 'accidente' ? 'Accidente laboral' :
                i.tipo === 'maternidad' ? 'Maternidad' :
                i.tipo === 'paternidad' ? 'Paternidad' :
                'Permiso sin goce'
                }}
            </td>
            <td>{{ i.fechaInicio }}</td>
            <td>{{ i.fechaFin }}</td>
            <td>{{ i.dias }}</td>
            <td>{{ i.numIncapacidad }}</td>
            <td>{{ formatearMes(i.mes) }}</td>
            <td>
                <button class="del" (click)="eliminar(i.id)">ğŸ—‘ï¸ Eliminar</button>
            </td>
        </tr>
    </tbody>
</table>

<p *ngIf="empleadoSeleccionado && incapacidades.length === 0">
    ğŸ“­ No hay incapacidades registradas para este empleado.
</p>

<style>
    select,
    input[type="date"] {
        padding: 6px;
        margin-bottom: 10px;
        border-radius: 6px;
        border: 1px solid #ccc;
    }

    .btns {
        margin-top: 10px;
    }

    button {
        padding: 8px 14px;
        border: none;
        background: #1976d2;
        color: white;
        border-radius: 6px;
        cursor: pointer;
        margin-right: 8px;
    }

    button[disabled] {
        background: #b5b5b5;
        cursor: not-allowed;
    }

    .sec {
        background: #555;
    }

    .del {
        background: #c62828;
    }

    .info-btn {
        background: #0d47a1;
    }

    .info-panel {
        background-color: #f7faff;
        border-left: 4px solid #1976d2;
        padding: 15px;
        margin-top: 12px;
        border-radius: 8px;
        font-size: 14px;
    }
</style>